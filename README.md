# AIoT 기반 스마트홈 시스템

지능형 주거 환경을 위한 **AIoT 기반 통합 스마트홈 시스템**입니다.  
재난 감지(지진/화재/가스), 환경 제어(온·습도/환기/날씨 연동), 출입 보안(RFID·카메라·PIR), 예약 자동화까지 하나의 플랫폼에서 통합 제어하는 것을 목표로 합니다.

---

## 🏛 전체 시스템 개요

### 시스템 목표

- 단순 ON/OFF 원격제어 수준을 넘어 **상황 인지 + 자동 대응**까지 수행하는 스마트홈
- 재난·보안·생활편의·에너지 절감을 모두 다루는 **통합 AIoT 플랫폼**
- 모바일/웹에서 실시간 모니터링, 제어, 로그 확인이 가능한 구조

### 전체 아키텍처

- **Raspberry Pi 5 (서버 + DB)**
  - 중앙 제어 서버, 웹 서버, REST/API 제공
  - 센서/디바이스 데이터 수집 및 가공
  - 사용자 설정, 예약 정보, 출입 로그, 알림 로그 저장

- **STM32 F411RE + ESP8266 (실내 센서·제어 노드)**
  - 온습도, 진동, 화재(연기+온도), 가스 센서 연결
  - 서보모터, LED, 부저, 전원 릴레이 등 액추에이터 제어
  - ESP8266을 통해 Wi-Fi로 서버와 양방향 통신

- **ESP32-CAM + PIR (외부 감시 노드)**
  - 방문자/침입 감지를 위한 PIR 모션 센서
  - ESP32-CAM을 이용한 실시간 영상 스트리밍
  - 저전력 모드 지원으로 배터리/전력 효율화

- **모바일 앱 / 웹 클라이언트**
  - 실시간 상태 대시보드
  - 원격 제어(조명·에어컨·창문·전원 등)
  - 예약 스케줄 설정 및 자동화 규칙 관리
  - 푸시 알림 및 로그 조회

---

## 🔥 재난 감지 및 안전 기능

### 1. 진동 감지 시스템

- SW-420 등 진동 센서를 이용해 **지진·충격 등 위험 진동 실시간 감지**
- 임계값 초과 시:
  - 부저/LED 경보
  - 서버로 즉시 이벤트 전송 → 모바일 앱 푸시 알림
- 진동 데이터 기록 및 분석을 통해 **이상 패턴 탐지 기반 확장** 가능

### 2. 화재 감지 시스템

- **연기 센서 + 온도 센서** 조합으로 화재 상황 감지
- 화재 발생 시:
  - 부저 경보 및 경고 LED 점등
  - 화재 발생 위치/시간 서버 로그 기록
  - 향후 자동 소방서 연락, 대피 경로 안내 시스템과 연동 가능하도록 설계

### 3. 가스 감지 시스템

- LPG, CO 등 **유해가스 농도 측정**
- 가스 누출 시:
  - 환기 시스템(창문·팬) 자동 작동
  - 위험 농도 구간에서는 경보 + 앱 알림
- 장기 데이터 분석을 통한 **누출 패턴 예측** 확장 가능

---

## 🌡 환경 제어 및 자동화

### 1. 온·습도 기반 냉난방 제어

- 실내 온·습도 센서를 통해 **24시간 환경 모니터링**
- 설정 온도 초과 시 에어컨 ON, 설정 온도 이하 시 난방기 ON
- 불필요한 냉난방을 줄이고 **쾌적한 실내 환경과 에너지 절감** 동시 달성

### 2. 날씨 API 연동 & 시각화

- **기상청 API**로 실시간 날씨/기온 데이터 수집
- **NTP 서버**로 현재 시간 자동 동기화
- LED 색상으로 직관적 표시:
  - 30℃ 이하 & 맑음: **초록 LED**
  - 30℃ 초과 & 맑음: **노랑 LED**
  - 30℃ 초과 or 비/눈: **빨강 LED**
- 날씨 변화에 따라 창문/냉난방 시스템 자동 대응

### 3. 스마트 창문 자동 제어(환기 시스템)

- 서보모터를 이용해 창문 개폐를 자동 제어
- 동작 조건:
  1. **시간 기반 제어** – 아침/저녁 자동 환기
  2. **날씨 연동 제어** – 비/눈 감지 시 자동 창문 닫힘
  3. **냉난방 연동 제어** – 냉난방 가동 중에는 창문 자동 닫힘
- 에너지 효율과 쾌적한 실내 공기를 동시에 추구

---

## 🧠 예약 시스템 및 자동 실행

- **조명 ON/OFF 예약** (반복 스케줄 포함)
- 에어컨/난방기 **온도 및 가동 시간 예약**
- 창문 개폐 시간 예약
- 예약 실행 전/후 앱 푸시 알림:
  - 실행 예정 알림, 실행 결과 알림
  - 예약 충돌 시 경고
  - 오작동 감지 시 즉시 알림 및 로그 기록

---

## 🔐 보안 및 출입 관리

### 1. 외부 감지 & 실시간 알림 (PIR + ESP32-CAM)

- 문 앞 PIR 센서로 움직임 감지 (최대 5–7 m, 약 110° 범위)
- 움직임 발생 시:
  - 서버/앱으로 즉시 푸시 알림
  - ESP32-CAM 영상 스트리밍으로 실시간 확인
- 사용자는 앱에서 상황을 즉시 확인하고 대응 가능

### 2. RFID 기반 출입 제어

- RFID 카드/태그를 이용한 출입 인증
- 사용자별 고유 ID 부여, 출입 로그 DB 저장
- ESP32-CAM과 연동하여 **출입자 영상 + 태그 정보 연계** 가능

### 3. 자동 전등 및 환경 제어

- 집에 들어올 때 RFID 태그 인식과 동시에 조명 ON
- 사용자 맞춤 조명/환경 프로파일 자동 적용
- 외출 시 자동 소등 및 절전 모드 전환

---

## 🧱 주요 하드웨어 구성

- **Raspberry Pi 5**
  - 서버/DB, 웹 서비스 및 API, 알림 처리
- **STM32 F411RE**
  - 센서 데이터 수집, 로컬 제어 로직, 액추에이터 제어
- **ESP8266**
  - STM32와 서버 간 Wi-Fi 통신 브리지
- **ESP32-CAM**
  - 실시간 영상 스트리밍 및 외부 감시
- **센서**
  - 온·습도 센서
  - 진동 센서(SW-420 등)
  - 화재(연기/온도) 센서
  - 가스 센서(LPG/CO)
  - PIR 모션 센서
- **액추에이터**
  - 서보모터(창문/차단기 제어)
  - LED 인디케이터
  - 부저
  - 전원 릴레이(대기전력 차단 등)

---

## 🎬 기능별 시연 영상 모음

| 진동 감지 | 화재 감지 | 가스 감지 |
| --- | --- | --- |
| ![](images/shakesensor.gif) | ![](images/firesensor.gif) | ![](images/gas%20senser.gif) |

| 온·습도/날씨 | 자동 히터 | 자동 창문 |
| --- | --- | --- |
| ![](images/weathersenter.gif) | ![](images/autotempureater.gif) | ![](images/autowindow.gif) |

| PIR 감지(입장/퇴장) | RFID 출입 |
| --- | --- |
| ![](images/pirsenserup.gif) ![](images/pirsenserdown.gif) | ![](images/rfidup.gif) |


